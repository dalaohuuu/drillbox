<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DrillBox 刷题</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div class="wrap">
    <header class="top">
      <div class="brand">DrillBox</div>

      <div class="topRight">
        <div class="pill" id="statsPill">—</div>
        <button class="btn smallBtn hidden" id="btnLogout" type="button">退出</button>
      </div>
    </header>

    <!-- 登录 -->
    <section class="card" id="loginCard">
      <h2>登录</h2>
      <p class="muted">输入口令开始刷题（在服务器 .env 里设置 APP_PASSCODE）。</p>
      <div class="row">
        <input id="passcode" type="password" placeholder="口令" />
        <button id="btnLogin" class="btn primary">进入</button>
      </div>
      <p class="muted small">提示：这是简化口令登录，适合个人/小范围使用。</p>
    </section>

    <!-- 主界面 -->
    <section class="card hidden" id="mainCard">

      <!-- ✅ 新增：导入 CSV -->
      <div class="importBox">
        <div class="importTitle">导入题库（CSV）</div>
        <div class="importRow">
          <input id="csvFile" type="file" accept=".csv,text/csv" />
          <button id="btnImport" class="btn">上传导入</button>
        </div>
        <div class="muted small">
          CSV 表头必须包含：<code>id,type,section,stem,options,answer,analysis</code><br/>
          选择题 options 需为 JSON 数组字符串，例如：<code>["A.xxx","B.yyy"]</code>
        </div>
        <div class="importResult hidden" id="importResult"></div>
      </div>

      <hr class="sep"/>

      <div class="controls">
        <select id="mode">
          <option value="random">随机刷</option>
          <option value="seq">顺序刷</option>
          <option value="wrong">只刷错题</option>
          <option value="starred">只刷⭐易错</option>
        </select>
        <select id="type"></select>
        <select id="section"></select>
      </div>

      <div class="qmeta" id="qmeta"></div>
      <div class="stem" id="stem">—</div>

      <div id="optionsBox" class="options hidden"></div>

      <div id="inputBox" class="inputbox hidden">
        <div id="blankInputs" class="blankInputs hidden"></div>
        <textarea id="answerText" rows="3" placeholder="输入答案（填空/文字题，可不填直接查看答案）"></textarea>
        <div class="muted small tip">多空填空题：每个空用一个输入框；提交时系统会按顺序判分。</div>
      </div>

      <div class="actions">
        <button id="btnStar" class="btn">⭐ 易错</button>
        <button id="btnShow" class="btn">查看答案</button>
        <button id="btnSubmit" class="btn primary">提交</button>
        <button id="btnNext" class="btn ghost">下一题</button>
      </div>

      <div class="feedback hidden" id="feedback"></div>

      <div class="answerBox hidden" id="answerBox">
        <div class="label">参考答案</div>
        <div class="text" id="answerTextView">—</div>

        <div class="label" style="margin-top:10px;">解析</div>
        <div class="text" id="analysisTextView">—</div>
      </div>
    </section>

    <footer class="foot muted small">
      手机优先刷题器 · Fastify + SQLite
    </footer>
  </div>

  <script src="/app.js"></script>
</body>
</html>
